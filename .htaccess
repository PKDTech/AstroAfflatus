RewriteEngine On

# Force HTTPS safely (no loop)
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

# Remove index.html duplicate
RewriteCond %{THE_REQUEST} \s/index\.html[\s?] [NC]
RewriteRule ^index\.html$ https://%{HTTP_HOST}/ [R=301,L]

# Allow direct asset files
RewriteRule ^songs/(.*)$ - [L]

# Route all unknown requests to index.html (for SPA)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.html [L]

# Error fallback
ErrorDocument 404 /index.html
ErrorDocument 403 /index.html
